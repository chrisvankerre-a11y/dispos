<!-- === FORMULAIRE DE DISPONIBILITÉS === -->
<div class="auto-fill-buttons">
  <button class="auto-btn auto-available" onclick="fillAll('available')">✅ Tout Disponible</button>
  <button class="auto-btn auto-unavailable" onclick="fillAll('unavailable')">❌ Tout Indisponible</button>
  <button class="auto-btn auto-maybe" onclick="fillAll('maybe')">❓ Tout Peut-être</button>
</div>

<div class="legend">
  <div class="legend-item"><span class="availability-option available">✓</span>Disponible</div>
  <div class="legend-item"><span class="availability-option unavailable">✗</span>Indisponible</div>
  <div class="legend-item"><span class="availability-option maybe">?</span>Peut-être</div>
</div>

<div class="calendar">
  <table id="availabilityTable">
    <thead>
      <tr><th>Date</th><th>Disponibilité</th></tr>
    </thead>
    <tbody id="tableBody"></tbody>
  </table>
</div>

<script>
const nonVotingDays = [
  "2025-11-01", "2025-11-02", "2025-11-08", "2025-11-09", 
  "2025-11-11", "2025-11-15", "2025-11-16"
];

let userSelections = {};

function generateNovemberDates() {
  const dates = [];
  const startDate = new Date('2025-11-01');
  const endDate = new Date('2025-11-21');
  for (let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 1)) {
    dates.push(new Date(d));
  }
  return dates;
}

function isNonVotingDay(date) {
  const dateString = date.toISOString().split('T')[0];
  return nonVotingDays.includes(dateString);
}

function createAvailabilityTable() {
  const tbody = document.getElementById('tableBody');
  tbody.innerHTML = '';
  const dates = generateNovemberDates();
  dates.forEach(date => {
    const tr = document.createElement('tr');
    const dateString = date.toISOString().split('T')[0];
    const day = date.getDate();
    const month = date.getMonth() + 1;

    const dateTd = document.createElement('td');
    dateTd.textContent = `${day}/${month}/${date.getFullYear()}`;
    if (isNonVotingDay(date)) dateTd.classList.add('non-voting-day');
    tr.appendChild(dateTd);

    const availabilityTd = document.createElement('td');
    if (isNonVotingDay(date)) {
      availabilityTd.classList.add('non-voting-day');
      availabilityTd.innerHTML = '<span style="color:#7f8c8d;">Non disponible</span>';
    } else {
      const types = [
        { value: 'available', symbol: '✓', class: 'available' },
        { value: 'unavailable', symbol: '✗', class: 'unavailable' },
        { value: 'maybe', symbol: '?', class: 'maybe' }
      ];
      types.forEach(t => {
        const label = document.createElement('label');
        const input = document.createElement('input');
        input.type = 'radio';
        input.name = `availability-${dateString}`;
        input.value = t.value;
        input.onchange = () => userSelections[dateString] = t.value;
        if (userSelections[dateString] === t.value) input.checked = true;

        const span = document.createElement('span');
        span.classList.add('availability-option', t.class);
        span.textContent = t.symbol;
        label.appendChild(input);
        label.appendChild(span);
        availabilityTd.appendChild(label);
      });
    }
    tr.appendChild(availabilityTd);
    tbody.appendChild(tr);
  });
}

function fillAll(status) {
  const dates = generateNovemberDates();
  dates.forEach(date => {
    if (!isNonVotingDay(date)) {
      const dateString = date.toISOString().split('T')[0];
      userSelections[dateString] = status;
    }
  });
  createAvailabilityTable();
}

document.addEventListener('DOMContentLoaded', createAvailabilityTable);
</script>
